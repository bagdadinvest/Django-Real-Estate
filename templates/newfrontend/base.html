{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>{% block title %}Villa Agency - Demo{% endblock %}</title>

    <!-- Vendor Bootstrap (shipped with newfront) -->
    <link href="{% static 'newfront/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Theme CSS -->
    <link rel="stylesheet" href="{% static 'newfront/assets/css/fontawesome.css' %}">
    <link rel="stylesheet" href="{% static 'newfront/assets/css/templatemo-villa-agency.css' %}">
    <link rel="stylesheet" href="{% static 'newfront/assets/css/owl.css' %}">
    <link rel="stylesheet" href="{% static 'newfront/assets/css/animate.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />

    <!-- WhatsApp widget CSS -->
<link href="
https://cdn.jsdelivr.net/npm/whatsapp-widget@1.2.0/dist/css/whatsapp-widget.min.css
" rel="stylesheet">

    {% block extra_css %}{% endblock %}
    <style>
      /* Language switcher styles (adapted from legacy navbar) */
      nav .language-switcher { margin-left: 12px; }
      nav .lang-switcher { position: relative; }
      nav .lang-current { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border: 1px solid #e5e7eb; border-radius: 999px; background: #fff; color: #111827; box-shadow: 0 2px 8px rgba(0,0,0,0.06); cursor: pointer; line-height: 1; }
      nav .lang-current .flag { width: 18px; height: 18px; border-radius: 2px; object-fit: cover; }
      nav .lang-current .code { font-weight: 600; font-size: 12px; letter-spacing: .3px; }
      nav .lang-current .chev { font-size: 12px; opacity: .7; }
      nav .lang-current:focus { outline: none; box-shadow: 0 0 0 3px rgba(59,130,246,.25); }
      nav .lang-menu { position: absolute; right: 0; top: calc(100% + 8px); min-width: 180px; background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; box-shadow: 0 10px 28px rgba(0,0,0,0.12); padding: 6px; display: none; z-index: 10000; }
      nav .lang-switcher.open .lang-menu { display: block; }
      nav .lang-item { margin: 0; }
      nav .lang-item + .lang-item { margin-top: 2px; }
      nav .lang-item button { width: 100%; display: flex; align-items: center; gap: 10px; padding: 8px 10px; background: transparent; border: 0; border-radius: 8px; cursor: pointer; font-size: 13px; color: #111827; text-align: left; }
      nav .lang-item button .flag { width: 18px; height: 18px; border-radius: 2px; object-fit: cover; }
      nav .lang-item button:hover { background: #f3f4f6; }
      @media (max-width: 768px) {
        nav .language-switcher { width: 100%; justify-content: center; margin: 10px 0 0; }
        nav .lang-menu { right: auto; left: 0; min-width: 200px; }
      }
    </style>
  </head>
  <body>
    <!-- Preloader -->
    <div id="js-preloader" class="js-preloader">
      <div class="preloader-inner">
        <span class="dot"></span>
        <div class="dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>

    <!-- Top sub-header -->
    <div class="sub-header">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-8">
            <ul class="info">
              <li><i class="fa fa-envelope"></i> info@company.com</li>
              <li><i class="fa fa-map"></i> Sunny Isles Beach, FL 33160</li>
            </ul>
          </div>
          <div class="col-lg-4 col-md-4">
            <ul class="social-links">
              <li><a href="#"><i class="fab fa-facebook"></i></a></li>
              <li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
              <li><a href="#"><i class="fab fa-linkedin"></i></a></li>
              <li><a href="#"><i class="fab fa-instagram"></i></a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Main header/nav -->
    <header class="header-area header-sticky">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <nav class="main-nav">
              <a href="{% url 'new_index' %}" class="logo"><h1>Villa</h1></a>
              <ul class="nav">
                <li><a href="{% url 'new_index' %}" class="{% block nav_home_active %}{% endblock %}">{% trans "Home" %}</a></li>
                <li><a href="{% url 'new_properties' %}" class="{% block nav_properties_active %}{% endblock %}">{% trans "Properties" %}</a></li>
                <li><a href="{% url 'new_properties' %}" class="{% block nav_details_active %}{% endblock %}">{% trans "Property Details" %}</a></li>
                <li><a href="{% url 'new_contact' %}" class="{% block nav_contact_active %}{% endblock %}">{% trans "Contact Us" %}</a></li>
                <li><a href="{% url 'new_map' %}" class="{% block nav_map_active %}{% endblock %}">{% trans "Map" %}</a></li>
                <li><a href="#"><i class="fa fa-calendar"></i> {% trans "Schedule a visit" %}</a></li>
              </ul>
              <!-- Language Switcher -->
              {% get_current_language as LANGUAGE_CODE %}
              {% get_available_languages as LANGUAGES %}
              <div class="language-switcher">
                <div class="lang-switcher" data-lang-current="{{ LANGUAGE_CODE }}">
                  {% with current_flag='flags/'|add:LANGUAGE_CODE|add:'.svg' %}
                    <button type="button" class="lang-current" aria-haspopup="true" aria-expanded="false" aria-label="{% trans 'Select language' %}">
                      <img class="flag" src="{% static current_flag %}" alt="{{ LANGUAGE_CODE }}">
                      <span class="code">{{ LANGUAGE_CODE|upper }}</span>
                      <span class="chev" aria-hidden="true">▾</span>
                    </button>
                  {% endwith %}
                  <div class="lang-menu" role="menu" aria-label="{% trans 'Available languages' %}">
                    {% for lang in LANGUAGES %}
                      {% with flag_file='flags/'|add:lang.0|add:'.svg' %}
                      <form action="{% url 'set_language' %}" method="post" class="lang-item">
                        {% csrf_token %}
                        <input name="next" type="hidden" value="{{ request.path }}">
                        <input type="hidden" name="language" value="{{ lang.0 }}">
                        <button type="submit" role="menuitem" aria-label="{{ lang.1 }}">
                          <img class="flag" src="{% static flag_file %}" alt="" aria-hidden="true">
                          <span class="label">{{ lang.1 }}</span>
                        </button>
                      </form>
                      {% endwith %}
                    {% endfor %}
                  </div>
                </div>
              </div>
              <a class="menu-trigger"><span>Menu</span></a>
            </nav>
          </div>
        </div>
      </div>
    </header>

    {% block content %}{% endblock %}

    <footer>
      <div class="container">
        <div class="col-lg-12">
          <p>Copyright © 2048 Villa Agency Co., Ltd. All rights reserved.
            Design: <a rel="nofollow" href="https://templatemo.com" target="_blank">TemplateMo</a></p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script src="{% static 'newfront/vendor/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'newfront/vendor/bootstrap/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'newfront/assets/js/isotope.min.js' %}"></script>
    <script src="{% static 'newfront/assets/js/owl-carousel.js' %}"></script>
    <script src="{% static 'newfront/assets/js/counter.js' %}"></script>
    <script src="{% static 'newfront/assets/js/custom.js' %}"></script>
    <script>
      // Language switcher interactions (adapted from legacy navbar)
      document.addEventListener('DOMContentLoaded', function() {
        var langSwitcher = document.querySelector('.lang-switcher');
        if (!langSwitcher) return;
        var langButton = langSwitcher.querySelector('.lang-current');
        var isTouch = false;
        function onFirstTouch(){ isTouch = true; window.removeEventListener('touchstart', onFirstTouch); }
        window.addEventListener('touchstart', onFirstTouch);
        function closeMenu(){ langSwitcher.classList.remove('open'); langButton && langButton.setAttribute('aria-expanded', 'false'); }
        function openMenu(){ langSwitcher.classList.add('open'); langButton && langButton.setAttribute('aria-expanded', 'true'); }
        function closeMenuOutside(event){ if (!langSwitcher.contains(event.target)) { closeMenu(); } }
        if (langButton) {
          langButton.addEventListener('click', function(){
            var isOpen = langSwitcher.classList.contains('open');
            if (isOpen) closeMenu(); else openMenu();
          });
        }
        if (!isTouch && window.matchMedia('(min-width: 768px)').matches) {
          langSwitcher.addEventListener('mouseenter', openMenu);
          langSwitcher.addEventListener('mouseleave', closeMenu);
        }
        document.addEventListener('click', closeMenuOutside);
        window.addEventListener('unload', function(){ document.removeEventListener('click', closeMenuOutside); });
      });
    </script>

    <!-- WhatsApp widget root (built-in form) -->
    <form id="whatsapp" class="wa-widget" action="905380546393" data-chat="whatsapp"></form>

    <!-- WhatsApp widget JS -->
<script src="
https://cdn.jsdelivr.net/npm/whatsapp-widget@1.2.0/dist/js/whatsapp-widget.min.js
"></script>
    <script>
      // Initialize WhatsApp widget
      var chat = new WhatsAppWidget(document.getElementById('whatsapp'), {
        // optional configs can be added here
      }, [
        // optional inputs array
      ]);
    </script>
    {% block extra_js %}{% endblock %}
  </body>
 </html>
